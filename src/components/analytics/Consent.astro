---
// Use frontmatter to check if the user already consented.
// (Note: In a real app, you might use cookies or a more robust state management solution.)
const consentAccepted = typeof localStorage !== 'undefined' && localStorage.getItem('cookieConsent') === 'accepted';
---
{!consentAccepted && (
  <>
    <div class="fixed inset-0 bg-black bg-opacity-50 z-40"></div>
    <div id="cookie-consent-banner" class="fixed left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white shadow-xl p-6 max-w-md w-full mx-4 z-50">
      <p class="text-gray-700 mb-4">Tento web používá cookies k zajištění optimální funkce a analýzy návštěvnosti. Pokračováním v prohlížení webu souhlasíte s používáním cookies.</p>
      <button id="accept-cookies" class="w-full bg-lightpink text-white py-2 px-4 hover:bg-lightpink transition-colors">Přijmout</button>
      <script is:inline>
        const acceptButton = document.getElementById("accept-cookies");
        const banner = document.getElementById("cookie-consent-banner");
        const overlay = banner.previousElementSibling;
        
        if (acceptButton && banner && overlay) {
          acceptButton.addEventListener("click", function () {
            // Update the consent mode to grant storage
            if (window.gtag) {
              window.gtag('consent', 'update', {
                'ad_storage': 'granted',
                'analytics_storage': 'granted'
              });
            }
            // Store the consent decision (localStorage, cookies, etc.)
            localStorage.setItem('cookieConsent', 'accepted');
            // Hide the banner and overlay
            banner.style.display = 'none';
            overlay.style.display = 'none';
          });
        }
      </script>
    </div>
  </>
)}
